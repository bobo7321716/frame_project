{"version":3,"sources":["assets\\homePage\\script\\manager\\TipManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { CommonTip } from \"../common/CommonTip\";\r\nimport MyPool from \"../common/MyPool\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class TipManager extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    protected tipNode: cc.Node = null;\r\n\r\n    @property(cc.Prefab)\r\n    protected tipPrefab: cc.Prefab = null;\r\n\r\n    public static ins: TipManager = null;\r\n    private tipNodeMap: Map<CommonTip, number> = new Map();\r\n    private tipArr: CommonTip[] = [];\r\n\r\n    onLoad(): void {\r\n        TipManager.ins = this;\r\n    }\r\n\r\n    public showTip(tipStr: string) {\r\n        var tip = MyPool.getObj(this.tipPrefab);\r\n        tip.setParent(this.tipNode);\r\n        tip.y = 0;\r\n        var commonTip = tip.getComponent(CommonTip);\r\n        commonTip.show(tipStr);\r\n        this.refreshTip(commonTip);\r\n    }\r\n\r\n    refreshTip(commonTip: CommonTip) {\r\n        if (this.tipNodeMap.size > 0) {\r\n            this.tipNodeMap.forEach((v, k) => {\r\n                k.topMove();\r\n            })\r\n        }\r\n        let gap = this.tipArr.length - 2;\r\n        if (gap > 0) {\r\n            for (let i = 0; i < gap; i++) {\r\n                let tip = this.tipArr.shift();\r\n                this.tipNodeMap.delete(tip);\r\n                tip.destroySelf();\r\n            }\r\n        }\r\n        this.tipNodeMap.set(commonTip, Date.now() + 1000);\r\n        this.tipArr.push(commonTip);\r\n    }\r\n\r\n    protected update(dt: number): void {\r\n        if (this.tipNodeMap.size <= 0) return;\r\n        this.tipNodeMap.forEach((v, k) => {\r\n            if (Date.now() >= v) {\r\n                this.tipNodeMap.delete(k);\r\n                let index = this.tipArr.indexOf(k);\r\n                this.tipArr.splice(index, 1);\r\n                k.hide();\r\n            }\r\n        })\r\n    }\r\n} \r\n"]}