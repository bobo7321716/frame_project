{"version":3,"sources":["assets\\homePage\\script\\common\\PlayerData.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import LevelConfig, { LevelConfigMgr } from \"../config/LevelConfig\";\r\nimport DataManager from \"../manager/DataManager\";\r\nimport { EventManager } from \"../manager/EventManager\";\r\nimport GamingData from \"./GamingData\";\r\nimport { EventEnum, LvInfo } from \"./Global\";\r\nimport { Util } from \"./Util\";\r\n\r\n\r\n\r\n//玩家数据类\r\nexport class PlayerData {\r\n\r\n    private static _ins: PlayerData = null;\r\n    public static gameName: string = \"GWYS\";\r\n\r\n    public static get ins(): PlayerData {\r\n        if (!this._ins) {\r\n            this._ins = new PlayerData();\r\n        }\r\n        return this._ins;\r\n    }\r\n\r\n    public static data = {};\r\n\r\n    /**\r\n     * 获取指定键名的值。\r\n     * @param key 键名。\r\n     */\r\n    setLoaclStorageItem(key: string, value: any) {\r\n        PlayerData.data[key] = value;\r\n        this.saveData();\r\n    }\r\n\r\n    saveData() {\r\n        for (let key in PlayerData.ins) {\r\n            if (PlayerData.ins[key] instanceof Function) {\r\n            } else {\r\n                PlayerData.data[key] = PlayerData.ins[key];\r\n            }\r\n        }\r\n        cc.sys.localStorage.setItem(PlayerData.gameName, JSON.stringify(PlayerData.data));\r\n    }\r\n\r\n    /**是否是新玩家 */\r\n    public isNewUser: boolean = true;\r\n    /**上次登录时间 */\r\n    public lastLoginTime: number = 0;\r\n    /**上次在线时长 */\r\n    public lastOnLineDur: number = 0;\r\n    /**本次离线时长 */\r\n    public logOutDuration: number = 0;\r\n    /**今日累计在线时长 */\r\n    public todayOnlineDuration: number = 0;\r\n    /**是否播放音效 */\r\n    public isPlayAudio: boolean = true;\r\n    /**是否播放bgm */\r\n    public isPlayMusic: boolean = true;\r\n    /**玩家等级 */\r\n    public playerLevel: number = 1;\r\n    /**累计登录天数 */\r\n    public totalLoginDays: number = 0;\r\n    /**签到天数 */\r\n    public signDay: number = 0;\r\n    /**玩家背包数据 */\r\n    public packageInfo: { id: number, num: number }[] = [];\r\n    /**关卡数据 */\r\n    public levelInfos: LvInfo[] = [];\r\n    /**观看广告次数 */\r\n    public finishAdTimes: number = 0;\r\n    /**限时解锁全部关卡的开始时间 */\r\n    public unlockAlllvTime: number = -1;\r\n\r\n    public initData() {\r\n        let localStorage = cc.sys.localStorage.getItem(PlayerData.gameName);\r\n        let data = {};\r\n        if (localStorage != null && localStorage != \"\") {\r\n            data = JSON.parse(localStorage);\r\n        }\r\n        PlayerData.data = data;\r\n        for (let key in PlayerData.ins) {\r\n            if (PlayerData.ins[key] instanceof Function) {\r\n            } else {\r\n                PlayerData.ins[key] = PlayerData.data[key] == undefined ? PlayerData.ins[key] : PlayerData.data[key];\r\n            }\r\n        }\r\n        this.initNewUserData();\r\n        this.checkIsNextDay();\r\n        this.logOutDuration = Date.now() - this.lastLoginTime - this.lastOnLineDur;\r\n        this.lastLoginTime = Date.now();\r\n        this.lastOnLineDur = 0;\r\n        this.intervalCheck();\r\n        this.saveData();\r\n    }\r\n\r\n    private initNewUserData() {\r\n        if (!this.isNewUser) return;\r\n        this.isNewUser = false;\r\n        this.lastLoginTime = Date.now();\r\n        this.lastOnLineDur = 0;\r\n        let levelConfigs = DataManager.ins.get(LevelConfigMgr).datas;\r\n        levelConfigs.forEach(v => {\r\n            let info = new LvInfo();\r\n            info.lv = v.id;\r\n            info.isUnlock = false;\r\n            info.unlockTips = [];\r\n            info.unlockEndings = [];\r\n            this.levelInfos.push(info);\r\n        })\r\n        this.saveData();\r\n    }\r\n\r\n    checkIsNextDay() {\r\n        if (Util.isNextDay(this.lastLoginTime, Date.now())) {\r\n            this.totalLoginDays++;\r\n            if (this.signDay > 7) {\r\n                this.signDay = 0;\r\n                this.totalLoginDays = 0;\r\n            }\r\n            this.todayOnlineDuration = 0;\r\n            // if (Util.isNextWeek(this.lastLoginTime, TimeManager.ins.curTime)) {\r\n            // }\r\n        }\r\n    }\r\n\r\n    intervalCheck() {\r\n        GamingData.isOnUnlockAllLv = this.unlockAlllvTime > 0 && (Date.now() - this.unlockAlllvTime) / 1000 / 60 / 60 < 24;\r\n        setInterval(() => {\r\n            GamingData.isOnUnlockAllLv = this.unlockAlllvTime > 0 && (Date.now() - this.unlockAlllvTime) / 1000 / 60 / 60 < 24;\r\n        }, 1000)\r\n    }\r\n\r\n    /**更新道具数量 */\r\n    changeItemNum(id: number, num: number, isRefresh: boolean = true, isSave: boolean = true) {\r\n        if (num == 0) return;\r\n        num = Math.floor(num);\r\n        let info = this.packageInfo.find(v => v.id == id);\r\n        if (!info) {\r\n            info = { id: id, num: num };\r\n            this.packageInfo.push(info);\r\n        } else {\r\n            info.num = Math.max(0, info.num + num);\r\n        }\r\n        isSave && this.saveData();\r\n        isRefresh && EventManager.triggerEvent(EventEnum.RefreshPlayerInfo, id);\r\n    }\r\n\r\n    /**获得道具数量 */\r\n    getItemNum(id: number) {\r\n        let info = this.packageInfo.find(v => v.id == id);\r\n        if (!info) return 0;\r\n        return info.num;\r\n    }\r\n\r\n    /**检查消耗是否充足 */\r\n    checkCostIsEnough(costs: { id: number, num: number }[], isLog: boolean = false, isCost: boolean = false, isPop: boolean = false) {\r\n        let isEnought = true;\r\n        // let logStr = \"\";\r\n        // costs.forEach((v, k) => {\r\n        //     let config = DataManager.ins.get(Gs_itemMgr).getDataById(v.id);\r\n        //     if (!config) return false;\r\n        //     let isEnought2 = this.getItemNum(v.id) >= v.num;\r\n        //     if (!isEnought2 && isEnought) isEnought = false;\r\n        //     if (!isEnought2 && isLog) {\r\n        //         logStr += config.Name + (k == costs.length - 1 ? \"不足\" : \",\");\r\n        //     }\r\n        //     if (isCost && isEnought2) this.changeItemNum(v.id, -v.num);\r\n        // })\r\n        // if (!isEnought && isLog) {\r\n        //     TipManager.ins.showTip(logStr);\r\n        // }\r\n        // if (isPop && !isEnought) {\r\n        //     // UIManager.ins.openView(UiPath.AddAssetsView).then((view: AddAssetsView) => {\r\n        //     //     view.init()\r\n        //     // })\r\n        // }\r\n\r\n        return isEnought;\r\n    }\r\n\r\n    getLvInfo(lv: number) {\r\n        return this.levelInfos.find(v => v.lv == lv);\r\n    }\r\n\r\n    passLv(lv: number, resultId: number) {\r\n        let info = this.levelInfos.find(v => v.lv == lv);\r\n        if (info) {\r\n            info.isUnlock = true;\r\n            info.unlockEndings.push(resultId);\r\n            let maxLvConfig = DataManager.ins.get(LevelConfigMgr).getMaxLvConfig();\r\n            GamingData.curLv = Math.min(GamingData.curLv + 1, maxLvConfig.id);\r\n        } else {\r\n            console.warn(\"关卡数据为空\")\r\n        }\r\n        this.saveData();\r\n    }\r\n\r\n    /**增加一次看广告次数 */\r\n    addFinishAd(sucCb: () => void) {\r\n        if (this.unlockAlllvTime > 0) return;\r\n        this.finishAdTimes++;\r\n        if (this.finishAdTimes >= 3) {\r\n            this.unlockAlllvTime = Date.now();\r\n            this.finishAdTimes = 0;\r\n            sucCb && sucCb();\r\n            this.saveData();\r\n        }\r\n    }\r\n\r\n    /**解锁关卡提示 */\r\n    unlockLvTip(lvConfig: LevelConfig, index: number = null) {\r\n        let lvInfo = this.getLvInfo(lvConfig.id);\r\n        if (!lvInfo) {\r\n            console.log(\"关卡未解锁\");\r\n            return;\r\n        }\r\n        if (index != null) {\r\n            let isUnlock = lvInfo.unlockTips.includes(index);\r\n            if (!isUnlock) {\r\n                lvInfo.unlockTips.push(index);\r\n                lvInfo.unlockTips.sort();\r\n                this.saveData();\r\n            }\r\n        } else {\r\n            lvInfo.unlockTips.sort();\r\n            for (let i = 0; i < lvConfig.tips.length; i++) {\r\n                if (!lvInfo.unlockTips.includes(i)) {\r\n                    lvInfo.unlockTips.push(i);\r\n                    lvInfo.unlockTips.sort();\r\n                    this.saveData();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nwindow[\"PlayerData\"] = PlayerData;"]}