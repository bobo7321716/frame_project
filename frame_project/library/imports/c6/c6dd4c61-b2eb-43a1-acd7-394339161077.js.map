{"version":3,"sources":["assets\\homePage\\script\\common\\AnimCol.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class AnimCol extends cc.Component {\r\n\r\n    @property(sp.Skeleton)\r\n    spine: sp.Skeleton = null;\r\n\r\n    @property(dragonBones.ArmatureDisplay)\r\n    dragon: dragonBones.ArmatureDisplay = null;\r\n\r\n    protected onLoad(): void {\r\n        if (this.dragon) {\r\n            this.dragon.premultipliedAlpha = false;\r\n            this.dragon.enableBatch = true;\r\n        }\r\n        if (!this.spine) {\r\n            this.spine = this.node.getComponent(sp.Skeleton);\r\n        }\r\n        if (!this.dragon) {\r\n            this.dragon = this.node.getComponent(dragonBones.ArmatureDisplay);\r\n        }\r\n    }\r\n\r\n    public get isPlaying() {\r\n        return (this.spine && this.spine.animation != null) || (this.dragon && this.dragon.animationName != null)\r\n    }\r\n\r\n    public play(animName: string = null, timeScale = 1, loopTimes: number = 0, endCb: () => void = null): Promise<void> {\r\n        return new Promise((resolve, reject) => {\r\n            let loopTimer: number = 0;\r\n            let completeCall = () => {\r\n                loopTimer++;\r\n                if (loopTimer >= loopTimes || loopTimes == 0) {\r\n                    this.dragon && this.dragon.removeEventListener(dragonBones.EventObject.COMPLETE, completeCall, this);\r\n                    resolve(null);\r\n                } else {\r\n                    this.spine.timeScale = timeScale;\r\n                    let name = animName ? animName : this.spine.defaultAnimation;\r\n                    this.spine.setAnimation(0, name, loopTimes == 0);\r\n                }\r\n            }\r\n            if (this.spine) {\r\n                endCb && this.spine.setEndListener(endCb);\r\n                this.spine.setCompleteListener(completeCall);\r\n                this.spine.timeScale = timeScale;\r\n                let name = animName ? animName : this.spine.defaultAnimation;\r\n                this.spine.setAnimation(0, name, loopTimes == 0);\r\n            } else if (this.dragon) {\r\n                this.dragon.timeScale = timeScale;\r\n                this.dragon.addEventListener(dragonBones.EventObject.COMPLETE, completeCall, this);\r\n                let name = animName ? animName : this.dragon.animationName;\r\n                this.dragon.playAnimation(name, loopTimes);\r\n            } else {\r\n                resolve(null);\r\n            }\r\n        })\r\n    }\r\n}\r\n"]}