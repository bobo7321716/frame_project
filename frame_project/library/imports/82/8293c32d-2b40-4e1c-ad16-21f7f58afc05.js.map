{"version":3,"sources":["assets\\homePage\\script\\manager\\UIManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import AbRef from \"../common/AbRef\";\r\nimport AnimationCol from \"../common/AnimationCol\";\r\nimport { BundleData } from \"../common/BundleData\";\r\nimport { BundleName } from \"../common/BundleName\";\r\nimport { EventEnum } from \"../common/Global\";\r\nimport MyPool from \"../common/MyPool\";\r\nimport { UiBase } from \"../common/UiBase\";\r\nimport { Util } from \"../common/Util\";\r\nimport { AbManager } from \"../manager/AbManager\";\r\nimport { EventManager } from \"../manager/EventManager\";\r\nimport SceneEventManager from \"../manager/SceneEventManager\";\r\n\r\n\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class UIManager extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    public boardNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    public dialogNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private uiBlockNode: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    private sceneBlockNode: cc.Node = null;\r\n\r\n    @property(cc.Prefab)\r\n    private touchPre: cc.Prefab = null;\r\n\r\n    @property(cc.Node)\r\n    maskNode: cc.Node = null;\r\n\r\n    private _isUiBlockInput: boolean = true;\r\n    public get isUiBlockInput(): boolean {\r\n        return this._isUiBlockInput;\r\n    }\r\n    private set isUiBlockInput(value: boolean) {\r\n        this._isUiBlockInput = value;\r\n        this.uiBlockNode.active = value;\r\n    }\r\n\r\n    /**全屏遮罩 */\r\n    private _isSceneBlockInput: boolean = false;\r\n    public get isSceneBlockInput(): boolean {\r\n        return this._isSceneBlockInput;\r\n    }\r\n    public set isSceneBlockInput(value: boolean) {\r\n        this._isSceneBlockInput = value;\r\n        this.sceneBlockNode.active = value;\r\n    }\r\n\r\n    public static ins: UIManager = null;\r\n\r\n    /**ui缩放 适配ipad等超宽屏幕时使用 */\r\n    public adapScale: number = 1;\r\n    /**是否是长屏手机 */\r\n    public isLongScene: boolean = false;\r\n\r\n    /**等待操作的界面队列 */\r\n    private operationViewQueue: { promise: any, bundleData: BundleData, operationType: UiOperationType, isNewLayer: boolean, paNode: cc.Node, pos: cc.Vec2, isImmediately: boolean }[] = [];\r\n    /**当前打开的界面栈 */\r\n    private viewStack: StackData[] = [];\r\n    /**当前正在执行的任务 */\r\n    private curTask: Promise<void> = Promise.resolve();\r\n\r\n    public isOnMaskAnim: boolean = false;\r\n    private _curTopBundleData: { data: BundleData; uiBase: UiBase } = null;\r\n    public get curTopBundleData(): { data: BundleData; uiBase: UiBase } {\r\n        return this._curTopBundleData;\r\n    }\r\n    private set curTopBundleData(value: { data: BundleData; uiBase: UiBase }) {\r\n        this._curTopBundleData = value;\r\n        // console.log(\"this._curTopBundleData = \", this._curTopBundleData)\r\n        SceneEventManager.ins.checkSceneEvent(value);\r\n        EventManager.triggerEvent(EventEnum.TopUIChange, value);\r\n    }\r\n\r\n    protected onLoad(): void {\r\n        UIManager.ins = this;\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.touchStart, this, true);\r\n        this.isUiBlockInput = false;\r\n        this.isSceneBlockInput = false;\r\n        this.isOnMaskAnim = false;\r\n        this.adapScale = Util.sceneAdaptation();\r\n        this.viewStack = [];\r\n        this.isLongScene = cc.winSize.height / cc.winSize.width > 2;\r\n    }\r\n\r\n    private limmitTime = 0;\r\n    private touchStart(event: cc.Event.EventTouch) {\r\n        if (!this.touchPre || cc.sys.now() - this.limmitTime < 150) {\r\n            return;\r\n        }\r\n        this.limmitTime = cc.sys.now();\r\n        let touchPos = this.node.convertToNodeSpaceAR(event.getLocation());\r\n        let touchEffect = MyPool.getObj(this.touchPre);\r\n        touchEffect.setParent(this.node);\r\n        touchEffect.setPosition(touchPos.x, touchPos.y);\r\n        let animScr = touchEffect.getComponent(AnimationCol);\r\n        if (animScr) {\r\n            animScr.play();\r\n        }\r\n    }\r\n\r\n    /**更新当前栈顶界面 */\r\n    public refreshCurTopBundleData() {\r\n        if (this.viewStack.length <= 0) {\r\n            this.curTopBundleData = null;\r\n        } else {\r\n            let lastStack = this.viewStack[this.viewStack.length - 1];\r\n            this.curTopBundleData = { data: lastStack.bundleData, uiBase: lastStack.uiBase };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 打开ui界面\r\n     * @param uiData ui数据\r\n     * @param isNewLayer 是否在新的层级打开，如果传false会隐藏栈顶界面再打开该界面，该界面关闭时会重新显示之前被隐藏的界面\r\n     * @param paNode 指定ui界面的父节点，可能会导致curTopBundleData出错\r\n     * * @param isImmediately 是否立刻打开（不播放动画）\r\n     * @returns \r\n     */\r\n    public openView(uiData: BundleData, isNewLayer: boolean = true, isImmediately: boolean = false, paNode: cc.Node = this.boardNode, pos: cc.Vec2 = cc.Vec2.ZERO): Promise<UiBase> {\r\n        return new Promise((resolve, reject) => {\r\n            let task = () => this.refreshOperationQueue({ promise: resolve, bundleData: uiData, operationType: UiOperationType.Open, isNewLayer: isNewLayer, paNode: paNode, pos: pos, isImmediately: isImmediately });\r\n            this.curTask = this.curTask.then(task);\r\n        })\r\n    }\r\n\r\n    /**关闭栈顶界面\r\n     * @param isImmediately 是否立刻关闭（不播放动画）\r\n     */\r\n    public closeView(isImmediately: boolean = false) {\r\n        return new Promise((resolve, reject) => {\r\n            if (this.viewStack.length <= 0) {\r\n                resolve && resolve(null);\r\n                return;\r\n            }\r\n            let task = () => this.refreshOperationQueue({ promise: resolve, bundleData: this.viewStack[this.viewStack.length - 1].bundleData, operationType: UiOperationType.Close, isNewLayer: null, paNode: null, pos: null, isImmediately: isImmediately });\r\n            this.curTask = this.curTask.then(task);\r\n        })\r\n    }\r\n\r\n    /**关闭指定界面 如果界面存在，会先将界面移动到栈顶，然后移除 */\r\n    public closeViewByBundleData(bundleData: BundleData, isImmediately: boolean = true) {\r\n        return new Promise((resolve, reject) => {\r\n            if (this.viewStack.length <= 0) {\r\n                resolve && resolve(null);\r\n                return;\r\n            }\r\n            let index = this.viewStack.findIndex(v => v.bundleData.url == bundleData.url);\r\n            if (index < 0) {\r\n                console.warn(\"未找到界面 \", bundleData);\r\n                resolve && resolve(null);\r\n                return;\r\n            }\r\n            let stackData = this.viewStack.splice(index, 1);\r\n            this.viewStack.push(stackData[0]);\r\n            let task = () => this.refreshOperationQueue({ promise: resolve, bundleData: this.viewStack[this.viewStack.length - 1].bundleData, operationType: UiOperationType.Close, isNewLayer: null, paNode: null, pos: null, isImmediately: isImmediately });\r\n            this.curTask = this.curTask.then(task);\r\n        })\r\n    }\r\n\r\n    refreshOperationQueue(info: { promise: any, bundleData: BundleData, operationType: UiOperationType, isNewLayer: boolean, paNode: cc.Node, pos: cc.Vec2, isImmediately: boolean }) {\r\n        return new Promise<void>((resolve, reject) => {\r\n            if (this.viewStack.length > 0) {\r\n                if (info.operationType == UiOperationType.Open) {\r\n                    let view = this.viewStack.find(v => v.bundleData.url == info.bundleData.url);\r\n                    if (view) {\r\n                        //当前要打开的界面已经打开\r\n                        info.promise && info.promise(view.uiBase);\r\n                        console.warn(\"界面已经打开 \", info.bundleData);\r\n                        resolve();\r\n                        return;\r\n                    }\r\n                } else if (info.operationType == UiOperationType.Close) {\r\n                    let stackData = this.viewStack[this.viewStack.length - 1];\r\n                    if (stackData.bundleData.url != info.bundleData.url) {\r\n                        //无法关闭\r\n                        info.promise && info.promise(null);\r\n                        console.warn(\"当前要关闭的界面不是最上层无法关闭 \", info.bundleData);\r\n                        resolve();\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            this.operationViewQueue.push(info);\r\n            this.checkSceneStack().then(resolve);\r\n        })\r\n    }\r\n\r\n    private checkSceneStack() {\r\n        return new Promise((resolve, reject) => {\r\n            let obj = this.operationViewQueue.shift();\r\n            if (!obj) {\r\n                return;\r\n            }\r\n            this.isUiBlockInput = true;\r\n            let uiData = obj.bundleData;\r\n            let uiResolve = obj.promise;\r\n            if (obj.operationType == UiOperationType.Open) {\r\n                this.getUi(uiData).then((node: cc.Node) => {\r\n                    let uiBase = node.getComponent(UiBase);\r\n                    if (!uiBase) {\r\n                        console.warn(\"没有获取到baseUi--- \", uiData);\r\n                        uiResolve && uiResolve(null);\r\n                        resolve && resolve(null);\r\n                        this.isUiBlockInput = false;\r\n                        return;\r\n                    }\r\n                    node.setParent(obj.paNode);\r\n                    node.setPosition(obj.pos);\r\n                    node.setScale(1);\r\n                    if (this.viewStack.length > 0) {\r\n                        if (!obj.isNewLayer) {\r\n                            this.viewStack[this.viewStack.length - 1].uiNode.active = false;\r\n                            this.viewStack[this.viewStack.length - 1].uiBase.onClose();\r\n                        } else {\r\n                            this.viewStack[this.viewStack.length - 1].uiBase.onCover();\r\n                        }\r\n                    }\r\n                    uiBase.onOpen();\r\n                    this.curTopBundleData = { data: uiData, uiBase: uiBase };\r\n                    this.viewStack.forEach(v => {\r\n                        if (v.uiBase.bgMaskNode) v.uiBase.bgMaskNode.active = false;\r\n                    })\r\n                    if (uiBase.bgMaskNode) uiBase.bgMaskNode.active = true;\r\n                    let stackData = new StackData(uiData, uiBase, node, obj.isNewLayer);\r\n                    this.viewStack.push(stackData);\r\n                    obj.promise && obj.promise(uiBase);\r\n                    uiBase.openAnimNode && uiBase.openAnimNode.setScale(0);\r\n                    uiBase.openPrepare().then(() => {\r\n                        this.uiOpenAnim(stackData, obj.isImmediately).then(() => {\r\n                            uiBase.onOpenFinish();\r\n                            resolve && resolve(null);\r\n                            this.isUiBlockInput = false;\r\n                        });\r\n                    });\r\n                }).catch(() => {\r\n                    console.warn(\"界面加载失败 \", uiData);\r\n                    obj.promise && obj.promise(null);\r\n                    resolve && resolve(null);\r\n                    this.isUiBlockInput = false;\r\n                })\r\n            } else if (obj.operationType == UiOperationType.Close) {\r\n                if (this.viewStack.length <= 0) {\r\n                    obj.promise && obj.promise();\r\n                    resolve && resolve(null);\r\n                    this.isUiBlockInput = false;\r\n                    return;\r\n                }\r\n                let view = this.viewStack[this.viewStack.length - 1];\r\n                view.uiBase.onClose();\r\n                view.uiBase.closeCb();\r\n                let stackData = new StackData(view.bundleData, view.uiBase, view.uiNode, view.isNewLayer);\r\n                this.uiCloseAnim(stackData, obj.isImmediately).then(() => {\r\n                    view.uiBase.onCloseFinish();\r\n                    this.viewStack.pop();\r\n                    this.decUi(view.uiNode);\r\n                    if (this.viewStack.length > 0) {\r\n                        let lastStack = this.viewStack[this.viewStack.length - 1];\r\n                        this.curTopBundleData = { data: lastStack.bundleData, uiBase: lastStack.uiBase };\r\n                        if (!view.isNewLayer) {\r\n                            lastStack.uiNode.active = true;\r\n                            lastStack.uiBase.onOpen();\r\n                        } else {\r\n                            lastStack.uiBase.onUncover();\r\n                        }\r\n                        if (lastStack.uiBase.bgMaskNode) {\r\n                            lastStack.uiBase.bgMaskNode.active = true;\r\n                        }\r\n                    } else {\r\n                        this.curTopBundleData = null;\r\n                    }\r\n                    obj.promise && obj.promise(view.uiBase);\r\n                    resolve && resolve(null);\r\n                    this.isUiBlockInput = false;\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    private uiOpenAnim(stackData: StackData, isImmediately: boolean): Promise<StackData> {\r\n        if (!stackData || !stackData.uiBase) {\r\n            return Promise.resolve(null);\r\n        }\r\n        if (isImmediately) {\r\n            if (stackData.uiBase.openAnimNode) {\r\n                stackData.uiBase.openAnimNode.stopAllActions();\r\n                stackData.uiBase.openAnimNode.setScale(1);\r\n            }\r\n            return Promise.resolve(null);\r\n        }\r\n        if (!stackData.uiBase.openAnimNode) {\r\n            return Promise.resolve(stackData);\r\n        } else {\r\n            return new Promise((resolve, reject) => {\r\n                stackData.uiBase.openAnimNode.stopAllActions();\r\n                stackData.uiBase.openAnimNode.setScale(0);\r\n                this.isUiBlockInput = true;\r\n                cc.tween(stackData.uiBase.openAnimNode)\r\n                    .to(0.5, { scale: 1 }, { easing: \"backOut\" })\r\n                    .call(() => {\r\n                        this.isUiBlockInput = false;\r\n                        resolve(stackData);\r\n                    })\r\n                    .start()\r\n            })\r\n        }\r\n    }\r\n\r\n    public uiCloseAnim(stackData: StackData, isImmediately: boolean): Promise<StackData> {\r\n        if (!stackData || !stackData.uiBase) {\r\n            return Promise.resolve(null);\r\n        }\r\n        if (isImmediately) {\r\n            return Promise.resolve(null);\r\n        }\r\n        if (!stackData.uiBase.openAnimNode) {\r\n            return Promise.resolve(stackData);\r\n        } else {\r\n            stackData.uiBase.openAnimNode.stopAllActions();\r\n            return new Promise((resolve, reject) => {\r\n                stackData.uiBase.openAnimNode.setScale(1);\r\n                this.isUiBlockInput = true;\r\n                cc.tween(stackData.uiBase.openAnimNode)\r\n                    .to(0.5, { scale: 0 }, { easing: \"backIn\" })\r\n                    .call(() => {\r\n                        this.isUiBlockInput = false;\r\n                        resolve(stackData);\r\n                    })\r\n                    .start()\r\n            })\r\n        }\r\n    }\r\n\r\n    /**加载ui界面 */\r\n    private getUi(bundleData: BundleData) {\r\n        return new Promise((resolve, reject) => {\r\n            AbManager.loadBundleResWitchTimeout(bundleData.bundle, bundleData.url, cc.Prefab).then((pre) => {\r\n                console.warn(\"pre \", pre)\r\n                resolve(cc.instantiate(pre));\r\n            }).catch(() => {\r\n                console.warn(\"reject\")\r\n                reject();\r\n            });\r\n        })\r\n    }\r\n\r\n    /**回收ui界面 */\r\n    private decUi(uiNode: cc.Node) {\r\n        uiNode.walk((cNode: cc.Node) => {\r\n            let abRef = cNode.getComponent(AbRef);\r\n            if (abRef) abRef.decRef();\r\n        }, null)\r\n        AbManager.decRef(uiNode._prefab.asset._uuid);\r\n        uiNode.removeFromParent(false);\r\n        uiNode.destroy();\r\n    }\r\n\r\n    /**\r\n     * 全屏黑色遮罩动画 渐显->渐隐\r\n     * @param time 动画时间\r\n     * @param midCb 屏幕完全变黑时的回调\r\n     * @param endCb 动画结束的回调\r\n     * @returns \r\n     */\r\n    public showMaskAnim(time: number, midCb: () => void = null, endCb: () => void = null) {\r\n        if (this.isOnMaskAnim) return;\r\n        this.isOnMaskAnim = true;\r\n        this.isUiBlockInput = true;\r\n        cc.tween(this.maskNode)\r\n            .to(time, { opacity: 255 })\r\n            .call(() => {\r\n                midCb && midCb();\r\n            })\r\n            .to(time, { opacity: 0 })\r\n            .call(() => {\r\n                endCb && endCb()\r\n                this.isUiBlockInput = false;\r\n                this.isOnMaskAnim = false;\r\n            })\r\n            .start()\r\n    }\r\n\r\n    /**\r\n     * 全屏渐显动画\r\n     * @param cb 动画完成回调\r\n     * @param duration 动画时长\r\n     * @returns \r\n     */\r\n    public showMask(cb?: () => void, duration = 0.5) {\r\n        if (this.isOnMaskAnim) return;\r\n        this.isOnMaskAnim = true;\r\n        this.isUiBlockInput = true;\r\n        this.maskNode.stopAllActions();\r\n        cc.tween(this.maskNode)\r\n            .to(duration, { opacity: 255 })\r\n            .call(() => {\r\n                this.isOnMaskAnim = false;\r\n                cb && cb();\r\n            })\r\n            .start();\r\n    }\r\n\r\n    /**\r\n     * 全屏渐隐动画\r\n     * @param cb 动画完成回调\r\n     * @param duration 动画时长\r\n     * @returns \r\n     */\r\n    public hideMask(cb?: () => void, duration = 0.5) {\r\n        if (this.isOnMaskAnim) return;\r\n        this.isOnMaskAnim = true;\r\n        this.maskNode.stopAllActions();\r\n        cc.tween(this.maskNode)\r\n            .to(duration, { opacity: 0 })\r\n            .call(() => {\r\n                this.isUiBlockInput = false;\r\n                this.isOnMaskAnim = false;\r\n                cb && cb();\r\n            })\r\n            .start();\r\n    }\r\n}\r\n\r\nexport class StackData {\r\n\r\n    public bundleData: BundleData = null;\r\n    public uiBase: UiBase = null;\r\n    public uiNode: cc.Node = null;\r\n    public isNewLayer: boolean = true;\r\n\r\n    constructor(bundleData: BundleData, uiBase: UiBase, uiNode: cc.Node, isNewLayer: boolean) {\r\n        this.bundleData = bundleData;\r\n        this.uiBase = uiBase;\r\n        this.uiNode = uiNode;\r\n        this.isNewLayer = isNewLayer;\r\n    }\r\n}\r\n\r\nexport enum UiType {\r\n    BOARD,\r\n    DIALOG,\r\n    POPUP,\r\n    SCENE\r\n}\r\n\r\nexport enum UiOperationType {\r\n    Open,\r\n    Close\r\n}\r\n"]}